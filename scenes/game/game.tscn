[gd_scene load_steps=48 format=3 uid="uid://bxp7xau32jb84"]

[ext_resource type="Script" uid="uid://dr4q8gjkx4jig" path="res://scenes/game/game.gd" id="1_5i0tg"]
[ext_resource type="Texture2D" uid="uid://4c70addhue8d" path="res://ENVIRONMENT/FOREGROUND.png" id="2_kelw5"]
[ext_resource type="Script" path="res://scenes/game/crt_warp_layer.gd" id="3_4j704"]
[ext_resource type="Texture2D" uid="uid://w3dq4f35hkiy" path="res://ENVIRONMENT/BACKGROUBD.png" id="3_kelw5"]
[ext_resource type="Texture2D" uid="uid://ck5txrr3tvr6u" path="res://ENVIRONMENT/DOOR.png" id="3_lfrn8"]
[ext_resource type="Texture2D" uid="uid://bm463ejkqw4x" path="res://LARRY/LARRY1.png" id="4_87uf6"]
[ext_resource type="PackedScene" uid="uid://cnywaxicq8l84" path="res://classes/UI/dialogue_player/dialogue_player.tscn" id="5_bdhmt"]
[ext_resource type="Script" uid="uid://dj61422p5d7k4" path="res://scenes/game/larry.gd" id="5_kp23o"]
[ext_resource type="Script" path="res://scenes/game/timer.gd" id="6_2a8rs"]
[ext_resource type="Shader" uid="uid://bwvvyvjuny2bu" path="res://assets/shaders/crt_blur.gdshader" id="6_5i0tg"]
[ext_resource type="FontFile" uid="uid://ccggu46ydt7dk" path="res://assets/fonts/AURORA-PRO.otf" id="6_bdhmt"]
[ext_resource type="AudioStream" uid="uid://cc3higdwoj53u" path="res://SFX/yapping.mp3" id="7_pg2xm"]
[ext_resource type="Texture2D" uid="uid://dt88jnsjno457" path="res://CORRUPTION/corruption_1.png" id="7_uyinl"]
[ext_resource type="Material" uid="uid://k8m18iwtsp" path="res://assets/materials/static.tres" id="9_10c2w"]
[ext_resource type="Texture2D" uid="uid://ynb66icovuxv" path="res://MENUS_nd_UI/Insanity_Under.png" id="9_ftsea"]
[ext_resource type="Texture2D" uid="uid://cwq6f7ujd1aqp" path="res://MENUS_nd_UI/Health_Over.png" id="10_3xj4h"]
[ext_resource type="Texture2D" uid="uid://cckblo8ia6r60" path="res://MENUS_nd_UI/Insanity_Fill.png" id="10_otnwt"]
[ext_resource type="Texture2D" uid="uid://cbvlxi4js64h0" path="res://MENUS_nd_UI/Health_Fill.png" id="11_5v6r0"]
[ext_resource type="Texture2D" uid="uid://dflq7y0j7fjmu" path="res://MENUS_nd_UI/Timer_Background.png" id="14_5v6r0"]
[ext_resource type="AudioStream" uid="uid://bttb6jk5svf0k" path="res://SFX/door_close.mp3" id="19_8b66f"]
[ext_resource type="PackedScene" uid="uid://cof30lnfmenqo" path="res://scenes/pause/pause.tscn" id="19_10c2w"]
[ext_resource type="Texture2D" uid="uid://2c86qdr7o7qx" path="res://MENUS_nd_UI/UI_door_close.png" id="19_gc57s"]
[ext_resource type="AudioStream" uid="uid://i1shuoexduwh" path="res://SFX/door_open.mp3" id="20_3jaai"]
[ext_resource type="Script" path="res://scenes/game/tutorial.gd" id="21_8b66f"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_lfrn8"]

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_87uf6"]
texture = ExtResource("3_kelw5")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_bdhmt"]
shader = ExtResource("6_5i0tg")
shader_parameter/hardScan = -10.0
shader_parameter/hardPix = -4.0
shader_parameter/hardBloomScan = -2.0
shader_parameter/hardBloomPix = -1.5
shader_parameter/bloomAmount = 0.0625
shader_parameter/warp = Vector2(0.015625, 0.0416667)
shader_parameter/maskDark = 0.5
shader_parameter/maskLight = 10.0
shader_parameter/wiggleMult = 0.0

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_bdhmt"]
texture = ExtResource("2_kelw5")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_4g8nm"]
bg_color = Color(0.682353, 0.00392157, 0.890196, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_58ldr"]
bg_color = Color(0.956357, 0.890148, 0.671849, 1)

[sub_resource type="Theme" id="Theme_87uf6"]
ProgressBar/styles/background = SubResource("StyleBoxFlat_4g8nm")
ProgressBar/styles/fill = SubResource("StyleBoxFlat_58ldr")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_87uf6"]
bg_color = Color(0.466667, 0, 0, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_5jirj"]
bg_color = Color(0.466667, 0.713726, 0, 1)

[sub_resource type="Theme" id="Theme_vaxfo"]
ProgressBar/styles/background = SubResource("StyleBoxFlat_87uf6")
ProgressBar/styles/fill = SubResource("StyleBoxFlat_5jirj")

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_3jaai"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_1iff4"]
bg_color = Color(0.391743, 0.901878, 0.92082, 0.141176)
corner_radius_top_left = 12
corner_radius_top_right = 12
corner_radius_bottom_right = 12
corner_radius_bottom_left = 12

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_4vuph"]
bg_color = Color(0.256753, 0.551658, 1, 0.372549)
corner_radius_top_left = 12
corner_radius_top_right = 12
corner_radius_bottom_right = 12
corner_radius_bottom_left = 12
shadow_color = Color(0, 0, 0, 0.396078)
shadow_size = 5
shadow_offset = Vector2(2, 5)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_wdnak"]
bg_color = Color(1, 1, 1, 0)
corner_radius_top_left = 12
corner_radius_top_right = 12
corner_radius_bottom_right = 12
corner_radius_bottom_left = 12

[sub_resource type="AtlasTexture" id="AtlasTexture_h48ew"]
atlas = ExtResource("19_gc57s")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_fty5b"]
bg_color = Color(0, 0, 0, 0.411765)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_l2dhg"]
bg_color = Color(1, 1, 1, 0.329412)

[sub_resource type="AtlasTexture" id="AtlasTexture_f2fum"]
atlas = ExtResource("3_lfrn8")
region = Rect2(26.2957, 112.569, 63.4075, 37.9117)

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_firvq"]
texture = SubResource("AtlasTexture_f2fum")

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_8krtj"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_fydea"]
bg_color = Color(0.299308, 0.527517, 0.660866, 1)
corner_radius_top_left = 12
corner_radius_top_right = 12
corner_radius_bottom_right = 12
corner_radius_bottom_left = 12

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_af6p5"]
bg_color = Color(0.367963, 0.609839, 0.752873, 1)
corner_radius_top_left = 12
corner_radius_top_right = 12
corner_radius_bottom_right = 12
corner_radius_bottom_left = 12
shadow_color = Color(0, 0, 0, 0.396078)
shadow_size = 5
shadow_offset = Vector2(2, 5)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_mumkj"]
bg_color = Color(0.266667, 0.482353, 0.607843, 1)
corner_radius_top_left = 12
corner_radius_top_right = 12
corner_radius_bottom_right = 12
corner_radius_bottom_left = 12
shadow_color = Color(0, 0, 0, 0.396078)
shadow_size = 5
shadow_offset = Vector2(2, 5)

[node name="Game" type="Node2D" node_paths=PackedStringArray("open_door_button", "door_pivot")]
script = ExtResource("1_5i0tg")
open_door_button = NodePath("UI/Controls/VBoxContainer/OpenDoor")
door_pivot = NodePath("Door/Door/SubViewportContainer/SubViewport/Door/Pivot")

[node name="Background" type="CanvasLayer" parent="."]

[node name="Background" type="Panel" parent="Background"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxEmpty_lfrn8")

[node name="AspectRatioContainer" type="AspectRatioContainer" parent="Background/Background"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
ratio = 0.905

[node name="Door" type="Panel" parent="Background/Background/AspectRatioContainer"]
texture_repeat = 2
layout_mode = 2
theme_override_styles/panel = SubResource("StyleBoxTexture_87uf6")

[node name="CRTWarp Layer" type="CanvasLayer" parent="."]
script = ExtResource("3_4j704")

[node name="CRTWarp" type="ColorRect" parent="CRTWarp Layer"]
material = SubResource("ShaderMaterial_bdhmt")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Larry" type="CanvasLayer" parent="."]
script = ExtResource("5_kp23o")

[node name="Larry" type="TextureRect" parent="Larry"]
anchors_preset = -1
anchor_left = 0.366406
anchor_top = 0.108333
anchor_right = 0.669531
anchor_bottom = 0.715277
texture = ExtResource("4_87uf6")
metadata/_edit_use_anchors_ = true

[node name="YapSFX" type="AudioStreamPlayer" parent="Larry/Larry"]
stream = ExtResource("7_pg2xm")
bus = &"SFX"

[node name="Corruption" type="TextureRect" parent="Larry"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 469.0
offset_top = 78.0
offset_right = -423.0
offset_bottom = -205.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("7_uyinl")

[node name="Foreground" type="CanvasLayer" parent="."]

[node name="Foreground" type="Panel" parent="Foreground"]
material = ExtResource("9_10c2w")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxTexture_bdhmt")

[node name="Sanity" type="CanvasLayer" parent="."]

[node name="SanityMeter" type="TextureProgressBar" parent="Sanity"]
texture_filter = 1
material = ExtResource("9_10c2w")
anchors_preset = -1
anchor_left = 0.0210938
anchor_top = 0.0986111
anchor_right = 0.117969
anchor_bottom = 0.981944
offset_right = -93.0
offset_bottom = -477.0
scale = Vector2(4, 4)
theme = SubResource("Theme_87uf6")
value = 25.0
fill_mode = 3
texture_under = ExtResource("9_ftsea")
texture_progress = ExtResource("10_otnwt")
metadata/_edit_use_anchors_ = true

[node name="Health" type="CanvasLayer" parent="."]

[node name="HealthMeter" type="TextureProgressBar" parent="Health"]
material = ExtResource("9_10c2w")
anchors_preset = -1
anchor_left = 0.138281
anchor_top = 0.388889
anchor_right = 0.213281
anchor_bottom = 0.988889
offset_right = -64.0
offset_bottom = -288.0
scale = Vector2(3, 3)
theme = SubResource("Theme_vaxfo")
value = 25.0
fill_mode = 3
nine_patch_stretch = true
texture_over = ExtResource("10_3xj4h")
texture_progress = ExtResource("11_5v6r0")
metadata/_edit_use_anchors_ = true

[node name="Timer" type="CanvasLayer" parent="."]
script = ExtResource("6_2a8rs")

[node name="ColorRect" type="TextureRect" parent="Timer"]
material = ExtResource("9_10c2w")
anchors_preset = -1
anchor_left = 0.0882813
anchor_top = 0.0319444
anchor_right = 0.200781
anchor_bottom = 0.108333
texture = ExtResource("14_5v6r0")
metadata/_edit_use_anchors_ = true

[node name="RichTextLabel" type="RichTextLabel" parent="Timer"]
anchors_preset = -1
anchor_left = 0.0882813
anchor_top = 0.0416667
anchor_right = 0.200781
anchor_bottom = 0.108333
offset_left = 1.0
offset_top = -2.0
offset_right = 1.0
offset_bottom = -2.0
bbcode_enabled = true
text = "[center][font_size=32][color=black]0:00[/color][/font_size][/center]"
metadata/_edit_use_anchors_ = true

[node name="DialoguePlayer" parent="." instance=ExtResource("5_bdhmt")]
process_mode = 3
scene_text_file = "res://scenes/yapper/monologue.json"
start_keys = Array[String](["open_1", "open_2", "open_3"])

[node name="Corruption" type="CanvasLayer" parent="."]

[node name="Door" type="CanvasLayer" parent="."]

[node name="Door" type="AspectRatioContainer" parent="Door"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
ratio = 0.905

[node name="SubViewportContainer" type="SubViewportContainer" parent="Door/Door"]
layout_mode = 2
mouse_filter = 2
stretch = true

[node name="SubViewport" type="SubViewport" parent="Door/Door/SubViewportContainer"]
transparent_bg = true
handle_input_locally = false
size = Vector2i(651, 720)
render_target_update_mode = 4

[node name="Camera3D" type="Camera3D" parent="Door/Door/SubViewportContainer/SubViewport"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 1, 0)
current = true
size = 1.33619

[node name="Door" type="Node3D" parent="Door/Door/SubViewportContainer/SubViewport"]

[node name="Pivot" type="Node3D" parent="Door/Door/SubViewportContainer/SubViewport/Door"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.7, 0, 0)

[node name="Sprite3D" type="Sprite3D" parent="Door/Door/SubViewportContainer/SubViewport/Door/Pivot"]
transform = Transform3D(0.855, 0, 0, 0, -3.73732e-08, 0.855, 0, -0.855, -3.73732e-08, 0.7, 0, 0)
texture = ExtResource("3_lfrn8")

[node name="DoorClose" type="AudioStreamPlayer" parent="Door"]
stream = ExtResource("19_8b66f")
bus = &"SFX"

[node name="DoorOpen" type="AudioStreamPlayer" parent="Door"]
stream = ExtResource("20_3jaai")
bus = &"SFX"

[node name="UI" type="CanvasLayer" parent="."]

[node name="Controls" type="Control" parent="UI"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="VBoxContainer" type="VBoxContainer" parent="UI/Controls"]
layout_mode = 2
offset_left = 1056.0
offset_top = 499.0
offset_right = 1173.0
offset_bottom = 682.0
grow_vertical = 2
alignment = 1

[node name="OpenDoor" type="Button" parent="UI/Controls/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
theme_override_colors/font_hover_color = Color(0, 0, 0, 1)
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_colors/font_focus_color = Color(0, 0, 0, 1)
theme_override_colors/font_pressed_color = Color(0, 0, 0, 1)
theme_override_fonts/font = ExtResource("6_bdhmt")
theme_override_styles/focus = SubResource("StyleBoxEmpty_3jaai")
theme_override_styles/hover = SubResource("StyleBoxFlat_1iff4")
theme_override_styles/pressed = SubResource("StyleBoxFlat_4vuph")
theme_override_styles/normal = SubResource("StyleBoxFlat_wdnak")

[node name="Sprite2D" type="Sprite2D" parent="UI/Controls/VBoxContainer/OpenDoor"]
position = Vector2(54, 85.125)
scale = Vector2(2.21875, 2.22187)
texture = SubResource("AtlasTexture_h48ew")

[node name="Pause" parent="." instance=ExtResource("19_10c2w")]

[node name="Tutorial" type="CanvasLayer" parent="." node_paths=PackedStringArray("timer_highlight", "health_highlight", "insanity_highlight", "open_door_highlight", "next_button", "text_label")]
process_mode = 3
layer = 5
script = ExtResource("21_8b66f")
timer_highlight = NodePath("Highlights/Timer")
health_highlight = NodePath("Highlights/Health")
insanity_highlight = NodePath("Highlights/Insanity")
open_door_highlight = NodePath("Highlights/OpenDoor")
next_button = NodePath("Tutorial/Next")
text_label = NodePath("Tutorial/Text")

[node name="Highlights" type="Control" parent="Tutorial"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Opacity" type="Panel" parent="Tutorial/Highlights"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_fty5b")

[node name="OpenDoor" type="Panel" parent="Tutorial/Highlights"]
visible = false
layout_mode = 0
offset_left = 1040.0
offset_top = 492.0
offset_right = 1192.0
offset_bottom = 683.0
theme_override_styles/panel = SubResource("StyleBoxFlat_l2dhg")

[node name="Timer" type="Panel" parent="Tutorial/Highlights"]
visible = false
layout_mode = 0
offset_left = 107.0
offset_top = 22.0
offset_right = 259.0
offset_bottom = 79.0
theme_override_styles/panel = SubResource("StyleBoxFlat_l2dhg")

[node name="Insanity" type="Panel" parent="Tutorial/Highlights"]
visible = false
layout_mode = 0
offset_left = 20.0
offset_top = 64.0
offset_right = 149.0
offset_bottom = 720.0
theme_override_styles/panel = SubResource("StyleBoxFlat_l2dhg")

[node name="Health" type="Panel" parent="Tutorial/Highlights"]
visible = false
layout_mode = 0
offset_left = 177.0
offset_top = 266.0
offset_right = 273.0
offset_bottom = 713.0
theme_override_styles/panel = SubResource("StyleBoxFlat_l2dhg")

[node name="Tutorial" type="Panel" parent="Tutorial"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -220.5
offset_top = -140.0
offset_right = 220.5
offset_bottom = 140.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxTexture_firvq")

[node name="Label" type="Label" parent="Tutorial/Tutorial"]
layout_mode = 1
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 68.0
grow_horizontal = 2
theme_override_fonts/font = ExtResource("6_bdhmt")
theme_override_font_sizes/font_size = 48
text = "Tutorial"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Text" type="Label" parent="Tutorial/Tutorial"]
layout_mode = 1
anchors_preset = 10
anchor_right = 1.0
offset_left = 3.5
offset_top = 76.0
offset_right = 3.5
offset_bottom = 193.0
grow_horizontal = 2
theme_override_font_sizes/font_size = 19
text = "Here you can click to open and close the door. You can always open it, but close it... Well, you have good manners, so sometimes you wait others finish talking."
horizontal_alignment = 1
vertical_alignment = 1
autowrap_mode = 3

[node name="Next" type="Button" parent="Tutorial/Tutorial"]
layout_mode = 1
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -100.0
offset_top = -57.0
offset_right = 100.0
offset_bottom = -13.0
grow_horizontal = 2
grow_vertical = 0
size_flags_vertical = 3
theme_override_colors/font_hover_color = Color(0, 0, 0, 1)
theme_override_colors/font_color = Color(0.427451, 0.0627451, 0.0627451, 1)
theme_override_colors/font_focus_color = Color(0.427451, 0.0627451, 0.0627451, 1)
theme_override_colors/font_pressed_color = Color(0.427451, 0.0627451, 0.0627451, 1)
theme_override_fonts/font = ExtResource("6_bdhmt")
theme_override_font_sizes/font_size = 36
theme_override_styles/focus = SubResource("StyleBoxEmpty_8krtj")
theme_override_styles/hover = SubResource("StyleBoxFlat_fydea")
theme_override_styles/pressed = SubResource("StyleBoxFlat_af6p5")
theme_override_styles/normal = SubResource("StyleBoxFlat_mumkj")
text = "Next
"

[connection signal="value_changed" from="Sanity/SanityMeter" to="Larry" method="_on_sanity_meter_value_changed"]
